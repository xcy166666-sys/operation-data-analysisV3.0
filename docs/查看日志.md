# æ—¥å¿—æ–‡ä»¶ä½ç½®è¯´æ˜

## ğŸ“‹ æ—¥å¿—ä½ç½®

### 1. Dockerå®¹å™¨æ—¥å¿—ï¼ˆæ¨èä½¿ç”¨ï¼‰

**æŸ¥çœ‹æœ€è¿‘æ—¥å¿—ï¼š**
```bash
docker-compose logs backend --tail 100
```

**å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼š**
```bash
docker-compose logs backend -f
```

**æŸ¥çœ‹ç‰¹å®šå†…å®¹ï¼š**
```bash
# æŸ¥çœ‹æŠ¥å‘Šç”Ÿæˆç›¸å…³
docker-compose logs backend --tail 500 | Select-String -Pattern "æŠ¥å‘Šç”Ÿæˆ|text_length"

# æŸ¥çœ‹Difyç›¸å…³
docker-compose logs backend --tail 500 | Select-String -Pattern "Dify|æ–‡å­—ç”Ÿæˆ"

# æŸ¥çœ‹å›¾è¡¨ç›¸å…³
docker-compose logs backend --tail 500 | Select-String -Pattern "å›¾è¡¨|chart|Bailian"

# æŸ¥çœ‹é”™è¯¯
docker-compose logs backend --tail 500 | Select-String -Pattern "error|Error|å¤±è´¥"
```

### 2. Docker Volumeå­˜å‚¨ä½ç½®

- **Volumeåç§°**: `operation-data-analysis_v20_backend_logs_v2`
- **å®¹å™¨å†…è·¯å¾„**: `/var/log/operation-analysis/`
- **ä¸»æœºè·¯å¾„**: `C:\ProgramData\docker\volumes\operation-data-analysis_v20_backend_logs_v2\_data`

**æ³¨æ„**: ç›®å‰æ—¥å¿—ç›®å½•æ˜¯ç©ºçš„ï¼Œæ—¥å¿—ä¸»è¦é€šè¿‡ Docker çš„ stdout/stderr è¾“å‡ºã€‚

### 3. æœ¬åœ°ä¿å­˜çš„æ—¥å¿—æ–‡ä»¶

å·²åˆ›å»º `backend_recent_logs.txt` æ–‡ä»¶ï¼ŒåŒ…å«æœ€è¿‘100æ¡æ—¥å¿—ã€‚

**ä¿å­˜æ—¥å¿—åˆ°æ–‡ä»¶ï¼š**
```bash
docker-compose logs backend --tail 1000 > backend_logs_$(Get-Date -Format 'yyyyMMdd_HHmmss').txt
```

### 4. å¿«é€ŸæŸ¥çœ‹è„šæœ¬

è¿è¡Œ `æŸ¥çœ‹æ—¥å¿—.ps1` è„šæœ¬å¯ä»¥å¿«é€ŸæŸ¥çœ‹ä¸åŒç±»å‹çš„æ—¥å¿—ã€‚

## ğŸ” å¸¸ç”¨æ—¥å¿—æŸ¥çœ‹å‘½ä»¤

```bash
# æŸ¥çœ‹æœ€è¿‘100æ¡æ—¥å¿—
docker-compose logs backend --tail 100

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çš„æ—¥å¿—
docker-compose logs --tail 100

# æŸ¥çœ‹ç‰¹å®šæ—¶é—´æ®µçš„æ—¥å¿—
docker-compose logs backend --since 10m

# æŸ¥çœ‹åŒ…å«ç‰¹å®šå…³é”®è¯çš„æ—¥å¿—
docker-compose logs backend --tail 500 | Select-String -Pattern "å…³é”®è¯"
```

## ğŸ“ æ—¥å¿—é…ç½®

æ—¥å¿—é…ç½®åœ¨ `backend/app/core/config.py` ä¸­ï¼š
- `LOG_LEVEL`: INFO
- `LOG_FILE`: /var/log/operation-analysis/app.log
- `LOG_ROTATION`: 10 MB
- `LOG_RETENTION`: 30 days

ä½†ç›®å‰æ—¥å¿—ä¸»è¦é€šè¿‡ loguru è¾“å‡ºåˆ° stdoutï¼Œç”± Docker æ•è·ã€‚

