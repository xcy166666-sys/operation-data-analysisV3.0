# 图表AI编辑功能 - 测试指南

## 📋 测试准备

### 1. 启动开发环境

**后端启动：**
```bash
cd backend
.\start_local.bat
```
- 确认后端运行在 http://localhost:8000
- 检查日志确认服务正常启动

**前端启动：**
```bash
cd frontend
npm run dev
```
- 确认前端运行在 http://localhost:5173
- 浏览器自动打开或手动访问

### 2. 登录系统
- 用户名：`admin`
- 密码：`admin123!`

### 3. 生成测试报告
1. 进入"数据分析"页面
2. 上传一个Excel文件（测试数据）
3. 输入分析需求，例如："生成一份用户活跃度分析报告，包含图表"
4. 点击"提交生成报告"
5. 等待报告生成完成

## 🧪 功能测试清单

### 测试1：悬停工具栏显示 ✅
**目标：** 验证鼠标悬停时工具栏正确显示

**步骤：**
1. 生成包含图表的报告
2. 将鼠标移动到图表区域上方
3. 观察底部工具栏是否滑入显示

**预期结果：**
- ✅ 图表边框变为蓝色高亮
- ✅ 底部工具栏从下方滑入
- ✅ 显示三个按钮：改颜色、换类型、AI修改
- ✅ 首次悬停显示新手提示："💡 点击可以编辑这个图表"

**验收标准：**
- 动画流畅，无卡顿
- 工具栏位置正确
- 按钮文字清晰可读

---

### 测试2：图表选中状态 ✅
**目标：** 验证点击图表后选中状态正确显示

**步骤：**
1. 点击图表区域
2. 观察选中状态的视觉反馈

**预期结果：**
- ✅ 图表边框保持蓝色高亮
- ✅ 右上角显示"已选中"徽章
- ✅ 工具栏保持显示
- ✅ 背景色变为浅蓝色（#f0f7ff）

**验收标准：**
- 选中状态明显可见
- 徽章动画自然
- 可以通过点击其他区域取消选中

---

### 测试3：快捷编辑 - 改颜色 ✅
**目标：** 验证颜色修改功能正常工作

**步骤：**
1. 悬停图表，点击"改颜色"按钮
2. 在弹出的面板中选择一个预设颜色（如绿色 #67c23a）
3. 点击"应用修改"
4. 等待修改完成

**预期结果：**
- ✅ 快捷编辑面板正确打开
- ✅ 显示8个预设颜色
- ✅ 选中的颜色有高亮边框
- ✅ 点击应用后显示加载状态
- ✅ 修改成功后图表颜色改变
- ✅ 显示成功提示消息

**验收标准：**
- 颜色选择器交互流畅
- 修改后图表立即更新
- 数据保持不变，只改变颜色
- 错误时显示友好提示

---

### 测试4：快捷编辑 - 换类型 ✅
**目标：** 验证图表类型切换功能

**步骤：**
1. 悬停图表，点击"换类型"按钮
2. 在弹出的面板中选择不同的图表类型（如从柱状图改为折线图）
3. 点击"应用修改"
4. 等待修改完成

**预期结果：**
- ✅ 快捷编辑面板正确打开
- ✅ 显示三种图表类型选项：柱状图、折线图、饼图
- ✅ 当前类型被选中
- ✅ 修改成功后图表类型改变
- ✅ 数据保持不变

**验收标准：**
- 类型切换准确
- 图表重新渲染正确
- 适配不同数据结构
- 保持图表可读性

---

### 测试5：AI自由修改 ✅
**目标：** 验证AI理解自然语言指令并修改图表

**步骤：**
1. 悬停图表，点击"AI修改"按钮
2. 在快捷编辑面板的"AI修改"区域输入指令，例如：
   - "改成渐变色，从蓝色到绿色"
   - "添加数据标签"
   - "调整图表高度为800px"
3. 点击"应用修改"
4. 等待AI处理和修改完成

**预期结果：**
- ✅ 快捷编辑面板正确打开
- ✅ AI指令输入框可用
- ✅ 支持多行输入
- ✅ AI正确理解指令
- ✅ 修改后的图表符合指令要求
- ✅ 显示成功提示

**验收标准：**
- AI理解准确度高
- 复杂指令也能处理
- 修改结果符合预期
- 失败时有明确错误提示

---

### 测试6：组合修改 ✅
**目标：** 验证同时应用多个修改

**步骤：**
1. 打开快捷编辑面板
2. 同时选择：
   - 颜色：橙色 #e6a23c
   - 类型：折线图
   - AI指令："添加平滑曲线效果"
3. 点击"应用修改"

**预期结果：**
- ✅ 所有修改同时生效
- ✅ 图表颜色、类型、样式都改变
- ✅ 修改协调一致

**验收标准：**
- 多个修改不冲突
- 最终效果美观
- 性能良好

---

### 测试7：AI对话模式编辑 ✅
**目标：** 验证通过AI对话面板修改图表

**步骤：**
1. 悬停图表，点击"AI修改"按钮
2. 系统自动打开AI对话面板
3. 在对话框中输入："把这个图表改成蓝色主题"
4. 发送消息
5. 等待AI响应和图表更新

**预期结果：**
- ✅ AI对话面板自动打开
- ✅ 显示提示消息
- ✅ AI理解图表修改意图
- ✅ 图表实时更新
- ✅ 对话历史记录修改操作

**验收标准：**
- 对话交互自然
- 图表更新及时
- 支持连续修改
- 历史可追溯

---

### 测试8：错误处理 ✅
**目标：** 验证各种错误情况的处理

**测试场景：**

#### 8.1 无会话时修改
- 清空当前会话
- 尝试修改图表
- **预期：** 显示"当前没有会话，无法修改图表"

#### 8.2 无图表时修改
- 生成纯文字报告（无图表）
- 尝试打开快捷编辑
- **预期：** 显示"当前没有图表可以修改"

#### 8.3 网络错误
- 断开网络连接
- 尝试修改图表
- **预期：** 显示网络错误提示

#### 8.4 AI生成失败
- 输入无效指令
- **预期：** 显示"图表修改失败，请重试"

**验收标准：**
- 所有错误都有友好提示
- 不会导致页面崩溃
- 用户可以重试操作

---

### 测试9：性能测试 ✅
**目标：** 验证功能性能表现

**测试项：**
1. **悬停响应时间**
   - 鼠标悬停到工具栏显示 < 300ms
   
2. **修改处理时间**
   - 简单修改（颜色）< 5秒
   - 复杂修改（AI指令）< 15秒
   
3. **图表更新时间**
   - 新HTML渲染 < 1秒

**验收标准：**
- 交互流畅无卡顿
- 加载状态明确
- 超时有提示

---

### 测试10：兼容性测试 ✅
**目标：** 验证在不同场景下的兼容性

**测试场景：**
1. **AI对话模式**
   - 图表在右侧面板显示
   - 工具栏正常工作
   
2. **查看历史报告模式**
   - 历史版本的图表可编辑
   - 修改不影响历史记录
   
3. **新建分析模式**
   - 新生成的图表可编辑
   - 修改后可保存

**验收标准：**
- 所有模式都支持编辑
- 功能行为一致
- 无布局错乱

---

## 🐛 Bug记录模板

发现问题时请记录：

```markdown
### Bug #X: [简短描述]

**严重程度：** 🔴高 / 🟡中 / 🟢低

**复现步骤：**
1. 
2. 
3. 

**预期结果：**


**实际结果：**


**截图/日志：**


**环境信息：**
- 浏览器：
- 操作系统：
- 前端版本：
- 后端版本：

**修复建议：**

```

---

## ✅ 测试完成标准

所有测试项通过后，功能可以发布：

- [ ] 10个功能测试全部通过
- [ ] 无严重Bug（🔴）
- [ ] 中等Bug（🟡）< 3个
- [ ] 性能指标达标
- [ ] 用户体验良好
- [ ] 文档完整

---

## 📝 测试报告模板

```markdown
# 图表AI编辑功能 - 测试报告

**测试日期：** YYYY-MM-DD
**测试人员：** [姓名]
**测试环境：** 本地开发环境

## 测试结果汇总

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 悬停工具栏 | ✅ / ❌ | |
| 图表选中 | ✅ / ❌ | |
| 改颜色 | ✅ / ❌ | |
| 换类型 | ✅ / ❌ | |
| AI修改 | ✅ / ❌ | |
| 组合修改 | ✅ / ❌ | |
| AI对话 | ✅ / ❌ | |
| 错误处理 | ✅ / ❌ | |
| 性能测试 | ✅ / ❌ | |
| 兼容性 | ✅ / ❌ | |

## 发现的问题

### 严重问题（🔴）
1. 

### 中等问题（🟡）
1. 

### 轻微问题（🟢）
1. 

## 改进建议

1. 
2. 
3. 

## 总体评价

[功能是否达到发布标准]

**签名：** ___________
**日期：** ___________
```

---

**文档版本：** 1.0
**创建时间：** 2025-12-24
**最后更新：** 2025-12-24
