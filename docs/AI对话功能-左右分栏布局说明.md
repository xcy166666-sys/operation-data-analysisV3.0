# AI对话功能 - 左右分栏布局说明

## 布局设计

### 整体布局（全屏对话模式）

```
┌────────────┬──────────────────┬─────────────────────────┐
│            │                  │                         │
│  历史会话   │   AI对话区域      │    报告展示区域          │
│  侧边栏     │                  │                         │
│            │  - 对话历史       │  - 报告文字内容          │
│  (280px)   │  - 消息输入       │  - 图表展示             │
│            │  - 发送按钮       │  - 操作按钮             │
│            │                  │                         │
│            │  (450px)         │  (自适应)               │
│            │                  │                         │
└────────────┴──────────────────┴─────────────────────────┘
```

**说明**：
- 点击"AI对话"按钮后，整个主内容区域切换为左右分栏布局
- 左侧：AI对话面板（450px宽）
- 右侧：报告展示区域（自适应宽度）
- 历史会话栏保持在最左侧（280px宽）

### 历史会话栏（280px宽，可调整）

**功能**：
- 显示历史会话列表
- 创建新会话
- 搜索会话
- 切换会话

**特点**：
- 默认宽度280px
- **可拖拽调整**：200px - 400px
- 深色背景
- 拖拽分隔条在右侧边缘

### 左侧对话面板（450px宽，可调整）

**功能**：
- 显示对话历史
- 输入消息
- 发送对话请求
- 查看AI回复
- 刷新历史
- 清除历史

**特点**：
- 默认宽度450px
- **可拖拽调整**：300px - 800px
- 独立滚动
- 浅灰色背景（#f8f9fa）
- 占满整个高度
- 拖拽分隔条在右侧边缘

### 右侧报告面板（自适应宽度）

**功能**：
- 显示报告文字内容
- 展示图表（HTML或JSON）
- 提供下载按钮
- 查看图表详情

**特点**：
- 自适应宽度（占满剩余空间）
- 独立滚动
- 白色背景
- 占满整个高度
- 内容区域有40px内边距

## 使用流程

### 1. 生成报告

首先需要生成报告：
1. 上传Excel文件
2. 输入分析需求
3. 点击"提交生成报告"
4. 等待报告生成完成

### 2. 开启对话模式

报告生成后：
1. 点击右上角"AI对话"按钮
2. **整个主内容区域**切换为全屏对话模式
3. 左侧显示AI对话面板（450px）
4. 右侧显示报告内容（自适应）
5. 历史会话栏保持在最左侧

### 3. 进行对话

在左侧对话面板：
1. 输入您的需求（如"将第一个图表改为柱状图"）
2. 按Enter或点击"发送"按钮
3. AI会处理您的请求
4. 右侧图表会自动更新

### 4. 关闭对话模式

再次点击"AI对话"按钮，返回普通报告查看模式。

## 交互特性

### 宽度调整

**历史会话栏**：
- 鼠标悬停在右侧边缘，光标变为 `↔`
- 按住鼠标左键拖拽调整宽度
- 宽度范围：200px - 400px
- 拖拽时显示当前宽度提示

**对话面板**：
- 鼠标悬停在右侧分隔条，光标变为 `↔`
- 按住鼠标左键拖拽调整宽度
- 宽度范围：300px - 800px
- 拖拽时显示当前宽度提示（如"450px"）

### 对话面板

- **欢迎消息**：首次打开显示欢迎信息和示例
- **消息气泡**：用户消息（蓝色）、AI消息（灰色）
- **时间显示**：智能显示相对时间（刚刚、X分钟前）
- **图表修改提示**：显示"已修改 X 个图表"
- **加载动画**：发送消息时显示加载动画

### 报告展示

- **文字内容**：Markdown格式渲染
- **图表展示**：HTML图表或JSON图表
- **操作按钮**：查看详情、下载图表、下载PDF
- **响应式**：自适应不同屏幕尺寸

## 样式特点

### 颜色方案

- **主色调**：蓝色（#409eff）
- **背景色**：白色（#ffffff）、浅灰（#fafafa）
- **边框色**：浅灰（#e0e0e0）
- **文字色**：深灰（#1d1d1f）、中灰（#666）

### 间距设计

- **面板间距**：0px（无间隙）
- **内容边距**：20-32px
- **元素间距**：12-24px

### 圆角设计

- **外层容器**：12px
- **消息气泡**：12px
- **按钮**：12px
- **输入框**：12px

## 技术实现

### 布局结构

```vue
<!-- 主内容区 -->
<div class="main-content">
  <!-- AI对话模式：占满整个主内容区 -->
  <div v-if="showDialogPanel && reportContent" class="dialog-mode-layout">
    <!-- 左侧对话面板 -->
    <div class="dialog-left-panel">
      <DialogPanel />
    </div>
    
    <!-- 右侧报告展示 -->
    <div class="dialog-right-panel">
      <div class="report-display">
        <!-- 报告内容 -->
      </div>
    </div>
  </div>
</div>
```

### CSS关键样式

```css
/* 对话模式布局 - 占满整个主内容区 */
.dialog-mode-layout {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  gap: 0;
  background: #ffffff;
  overflow: hidden;
  z-index: 10;
}

/* 对话模式时，隐藏main-content的padding */
.main-content:has(.dialog-mode-layout) {
  padding: 0;
  overflow: hidden;
}

.dialog-left-panel {
  width: 450px;
  min-width: 400px;
  max-width: 600px;
  height: 100%;
}

.dialog-right-panel {
  flex: 1;
  height: 100%;
  overflow-y: auto;
}
```

## 优势

### 1. 更好的用户体验

- **同时查看**：对话和报告同时可见
- **实时反馈**：图表修改立即显示
- **上下文清晰**：对话历史和报告内容一目了然

### 2. 更高的效率

- **无需切换**：不需要在对话和报告之间切换
- **快速迭代**：可以连续多次调整图表
- **直观对比**：修改前后效果对比明显

### 3. 更强的沉浸感

- **专注模式**：左右分栏提供专注的工作环境
- **流畅交互**：对话和查看无缝衔接
- **视觉平衡**：左右布局视觉平衡舒适

## 响应式设计

### 大屏幕（>1920px）

- 左侧面板：400px
- 右侧面板：自适应，最大1200px居中

### 中等屏幕（1366-1920px）

- 左侧面板：400px
- 右侧面板：自适应

### 小屏幕（<1366px）

- 左侧面板：350px
- 右侧面板：自适应
- 建议使用全屏模式

## 后续优化

### 短期

- [ ] 支持拖拽调整左侧面板宽度
- [ ] 支持折叠左侧面板
- [ ] 支持全屏模式

### 中期

- [ ] 支持多标签页（多个报告）
- [ ] 支持对话历史搜索
- [ ] 支持导出对话记录

### 长期

- [ ] 支持分屏对比（多个报告对比）
- [ ] 支持协作模式（多人对话）
- [ ] 支持移动端适配

## 参考

- 设计灵感：类似于ChatGPT、Claude等AI对话界面
- 布局参考：左侧对话、右侧内容的经典布局
- 交互参考：现代化的消息应用界面
