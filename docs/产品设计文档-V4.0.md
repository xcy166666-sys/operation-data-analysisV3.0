# 运营数据分析平台 V4.0 产品设计文档

> 基于第一性原理重新思考数据分析产品的本质

---

## 第一部分：第一性原理分析

### 1.1 什么是数据分析的本质？

**回归本质问题**：用户为什么需要数据分析？

```
数据 → [黑盒] → 决策
```

用户拥有数据，但数据本身没有价值。用户真正需要的是：
1. **理解**：发生了什么？（What happened?）
2. **洞察**：为什么发生？（Why?）
3. **预测**：接下来会怎样？（What's next?）
4. **行动**：我应该做什么？（What to do?）

### 1.2 传统数据分析的痛点

| 痛点 | 描述 | 用户心声 |
|------|------|----------|
| **门槛高** | 需要SQL、Python、统计学知识 | "我只想知道结果，不想学编程" |
| **耗时长** | 从数据到报告需要数小时甚至数天 | "老板要的是今天的数据，不是上周的" |
| **不直观** | 表格和数字难以理解 | "给我一张图，别给我一堆数字" |
| **断层严重** | 分析完还要手动写报告 | "分析完了还要再整理一遍" |
| **缺乏指导** | 只有数据，没有建议 | "所以我到底该怎么做？" |

### 1.3 第一性原理推导

**核心公式**：

```
价值 = (洞察深度 × 行动指导) / (时间成本 × 学习成本)
```

要最大化价值，需要：
- **最大化**：洞察深度、行动指导
- **最小化**：时间成本、学习成本

**推导结论**：

| 原则 | 实现方式 |
|------|----------|
| 零门槛 | 自然语言交互，上传即分析 |
| 即时性 | 秒级响应，流式输出 |
| 可视化 | 图表优先，数据支撑 |
| 端到端 | 数据→分析→报告→行动，一站式 |
| 智能化 | AI理解意图，主动建议 |

### 1.4 产品愿景

> **让每个人都能像数据科学家一样思考，像业务专家一样决策**

**一句话定位**：
```
上传数据，提出问题，获得答案和行动建议
```

---

## 第二部分：用户研究

### 2.1 用户画像

#### 画像A：运营专员（主要用户）

| 维度 | 描述 |
|------|------|
| 角色 | 游戏运营、产品运营、市场运营 |
| 技能 | 熟悉Excel，不会SQL/Python |
| 需求 | 快速出日报/周报，追踪KPI |
| 痛点 | 数据散落各处，整理耗时 |
| 场景 | 晨会汇报、周会复盘、异常排查 |

#### 画像B：数据分析师（高级用户）

| 维度 | 描述 |
|------|------|
| 角色 | BI分析师、数据分析师 |
| 技能 | SQL熟练，会Python |
| 需求 | 深度分析，自定义报告 |
| 痛点 | 重复性工作多，报告模板化 |
| 场景 | 专项分析、AB测试、归因分析 |

#### 画像C：业务决策者（最终用户）

| 维度 | 描述 |
|------|------|
| 角色 | 产品经理、运营总监、CEO |
| 技能 | 看报告，不做分析 |
| 需求 | 一眼看到结论和建议 |
| 痛点 | 报告太长，找不到重点 |
| 场景 | 决策会议、投资汇报 |

### 2.2 用户旅程地图

```
┌─────────────────────────────────────────────────────────────────────┐
│                         用户旅程地图                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  阶段    │ 获取数据 │ 提出问题 │ 查看结果 │ 深入探索 │ 输出报告 │ 行动    │
│          │         │         │         │         │         │        │
│  ────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────│
│          │         │         │         │         │         │        │
│  用户    │ 上传    │ 输入    │ 阅读    │ 追问    │ 导出    │ 执行   │
│  行为    │ 文件    │ 需求    │ 报告    │ AI     │ 分享    │ 决策   │
│          │         │         │         │         │         │        │
│  ────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────│
│          │         │         │         │         │         │        │
│  情绪    │ 期待    │ 好奇    │ 满足/   │ 深入    │ 成就感  │ 信心   │
│          │         │         │ 困惑    │         │         │        │
│          │         │         │         │         │         │        │
│  ────────┼─────────┼─────────┼─────────┼─────────┼─────────┼────────│
│          │         │         │         │         │         │        │
│  机会点  │ 智能    │ 意图    │ 分层    │ 对话式  │ 多格式  │ 行动   │
│          │ 识别    │ 理解    │ 展示    │ 探索    │ 输出    │ 建议   │
│          │         │         │         │         │         │        │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.3 核心场景

| 场景 | 描述 | 频率 | 价值 |
|------|------|------|------|
| **日报生成** | 每日核心指标汇总 | 每天 | 高 |
| **周报复盘** | 周度数据对比分析 | 每周 | 高 |
| **异常排查** | 指标异常时快速定位原因 | 随时 | 极高 |
| **专项分析** | 深入某个主题的分析 | 月度 | 高 |
| **AB测试** | 实验组对照组对比 | 项目制 | 高 |
| **汇报材料** | 给领导/投资人的报告 | 季度 | 极高 |

---

## 第三部分：产品需求文档（PRD）

### 3.1 产品定位

| 维度 | 描述 |
|------|------|
| 产品名称 | 智析（ZhiXi）- AI数据分析助手 |
| 一句话描述 | 上传数据，对话分析，一键报告 |
| 目标用户 | 需要数据分析但缺乏技术能力的业务人员 |
| 核心价值 | 将数据分析门槛降至零，分析时间缩短90% |

### 3.2 产品原则

| 原则 | 描述 | 优先级 |
|------|------|--------|
| **简单至上** | 功能再强大，入口必须简单 | P0 |
| **结果导向** | 用户要的是答案，不是过程 | P0 |
| **智能优先** | 能自动的绝不手动 | P1 |
| **渐进披露** | 简单问题简单答，复杂需求深入挖 | P1 |
| **信任透明** | AI的推理过程可追溯 | P2 |

### 3.3 功能需求

#### 3.3.1 核心功能模块

```
┌─────────────────────────────────────────────────────────────┐
│                      智析 - 功能架构                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   数据接入   │  │   智能分析   │  │   报告输出   │        │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤        │
│  │ • 文件上传   │  │ • 自然语言   │  │ • 在线预览   │        │
│  │ • 数据库连接 │  │ • 意图理解   │  │ • PDF导出   │        │
│  │ • API对接   │  │ • 自动图表   │  │ • PPT生成   │        │
│  │ • 实时数据   │  │ • 深度洞察   │  │ • 链接分享   │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   对话探索   │  │   模板中心   │  │   协作空间   │        │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤        │
│  │ • 追问深挖   │  │ • 日报模板   │  │ • 团队共享   │        │
│  │ • 图表编辑   │  │ • 周报模板   │  │ • 评论批注   │        │
│  │ • 数据下钻   │  │ • 自定义    │  │ • 版本历史   │        │
│  │ • 对比分析   │  │ • 行业模板   │  │ • 权限管理   │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 3.3.2 功能优先级矩阵

| 功能 | 用户价值 | 实现难度 | 优先级 | 版本 |
|------|----------|----------|--------|------|
| 文件上传分析 | 极高 | 低 | P0 | V4.0 |
| 自然语言提问 | 极高 | 中 | P0 | V4.0 |
| 自动生成图表 | 高 | 中 | P0 | V4.0 |
| AI对话深挖 | 高 | 中 | P0 | V4.0 |
| 报告PDF导出 | 高 | 低 | P0 | V4.0 |
| 模板中心 | 中 | 低 | P1 | V4.1 |
| 数据库连接 | 中 | 高 | P1 | V4.1 |
| PPT生成 | 中 | 高 | P2 | V4.2 |
| 团队协作 | 中 | 高 | P2 | V4.2 |
| 实时数据看板 | 低 | 极高 | P3 | V5.0 |

### 3.4 用户故事

#### Epic 1：数据分析

```
作为 运营专员
我想要 上传Excel后自动获得分析报告
以便于 快速完成日常数据汇报工作

验收标准：
- [ ] 支持xlsx/csv格式上传
- [ ] 文件大小限制50MB
- [ ] 30秒内生成初步报告
- [ ] 报告包含数据概览、趋势分析、关键发现
```

#### Epic 2：智能问答

```
作为 产品经理
我想要 用自然语言向AI提问数据问题
以便于 不用写SQL也能获得数据洞察

验收标准：
- [ ] 支持中文自然语言输入
- [ ] 理解业务术语（如DAU、留存率）
- [ ] 5秒内返回回答
- [ ] 支持追问和上下文记忆
```

#### Epic 3：可视化编辑

```
作为 数据分析师
我想要 编辑和调整自动生成的图表
以便于 输出符合品牌规范的报告

验收标准：
- [ ] 支持修改图表类型
- [ ] 支持调整颜色主题
- [ ] 支持编辑标题和标签
- [ ] 实时预览修改效果
```

#### Epic 4：报告输出

```
作为 业务决策者
我想要 一键导出专业的分析报告
以便于 在会议上展示和分享

验收标准：
- [ ] 支持PDF格式导出
- [ ] 报告包含封面、目录、正文
- [ ] 图表清晰可读
- [ ] 支持添加公司Logo
```

---

## 第四部分：总体架构设计

### 4.1 系统架构图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                              用户层                                      │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐                  │
│  │   Web端      │  │   移动端      │  │   API接入    │                  │
│  │  (Vue 3)     │  │  (响应式)     │  │  (REST)     │                  │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘                  │
└─────────┼─────────────────┼─────────────────┼───────────────────────────┘
          │                 │                 │
          └────────────────┬┴─────────────────┘
                           │
┌──────────────────────────┴──────────────────────────────────────────────┐
│                            网关层                                        │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │                     API Gateway (Kong/Nginx)                      │  │
│  │  • 负载均衡  • 限流熔断  • 认证授权  • 请求路由  • 日志追踪      │  │
│  └──────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────┬───────────────────────────────────────┘
                                  │
┌─────────────────────────────────┴───────────────────────────────────────┐
│                            服务层                                        │
│                                                                         │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐        │
│  │   用户服务       │  │   分析服务       │  │   报告服务       │        │
│  │  User Service   │  │ Analysis Service│  │ Report Service  │        │
│  ├─────────────────┤  ├─────────────────┤  ├─────────────────┤        │
│  │ • 认证登录       │  │ • 文件解析       │  │ • 报告生成       │        │
│  │ • 权限管理       │  │ • 数据处理       │  │ • 模板管理       │        │
│  │ • 用户配置       │  │ • AI调用        │  │ • 导出服务       │        │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘        │
│                                                                         │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐        │
│  │   对话服务       │  │   图表服务       │  │   通知服务       │        │
│  │ Dialog Service  │  │  Chart Service  │  │ Notify Service  │        │
│  ├─────────────────┤  ├─────────────────┤  ├─────────────────┤        │
│  │ • 会话管理       │  │ • 图表生成       │  │ • 邮件通知       │        │
│  │ • 上下文记忆     │  │ • 图表编辑       │  │ • 消息推送       │        │
│  │ • 意图识别       │  │ • 主题管理       │  │ • 任务状态       │        │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘        │
│                                                                         │
└─────────────────────────────────┬───────────────────────────────────────┘
                                  │
┌─────────────────────────────────┴───────────────────────────────────────┐
│                            AI层                                          │
│                                                                         │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │                      AI Gateway（统一调度）                        │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐        │
│  │   意图识别引擎   │  │   分析推理引擎   │  │   生成引擎       │        │
│  │  Intent Engine  │  │ Reasoning Engine│  │ Generate Engine │        │
│  ├─────────────────┤  ├─────────────────┤  ├─────────────────┤        │
│  │ • 问题分类       │  │ • 数据理解       │  │ • 文本生成       │        │
│  │ • 实体抽取       │  │ • 趋势分析       │  │ • 图表配置       │        │
│  │ • 槽位填充       │  │ • 异常检测       │  │ • 报告撰写       │        │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘        │
│                                                                         │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │               外部AI服务（可插拔）                                  │  │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐         │  │
│  │  │ 阿里百炼  │  │   Dify   │  │  OpenAI  │  │  Claude  │         │  │
│  │  └──────────┘  └──────────┘  └──────────┘  └──────────┘         │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
└─────────────────────────────────┬───────────────────────────────────────┘
                                  │
┌─────────────────────────────────┴───────────────────────────────────────┐
│                            数据层                                        │
│                                                                         │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐        │
│  │   PostgreSQL    │  │     Redis       │  │   对象存储       │        │
│  ├─────────────────┤  ├─────────────────┤  ├─────────────────┤        │
│  │ • 用户数据       │  │ • 会话缓存       │  │ • 上传文件       │        │
│  │ • 分析会话       │  │ • 热点数据       │  │ • 生成报告       │        │
│  │ • 报告历史       │  │ • 任务队列       │  │ • 图表图片       │        │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘        │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 4.2 技术选型

| 层级 | 技术 | 选型理由 |
|------|------|----------|
| **前端框架** | Vue 3 + TypeScript | 现有技术栈，团队熟悉 |
| **UI组件库** | Arco Design Vue | 设计精美，组件丰富 |
| **图表库** | ECharts 5 | 功能强大，文档完善 |
| **后端框架** | FastAPI | 高性能，异步支持好 |
| **数据库** | PostgreSQL 15 | 稳定可靠，JSON支持好 |
| **缓存** | Redis 7 | 高性能，数据结构丰富 |
| **AI服务** | 多平台集成 | 灵活切换，避免锁定 |
| **对象存储** | MinIO/OSS | 文件存储标准方案 |
| **消息队列** | Redis Stream | 轻量级，满足需求 |

### 4.3 数据模型设计

#### 核心实体关系图

```
┌─────────────┐       ┌─────────────┐       ┌─────────────┐
│    User     │       │   Session   │       │   Report    │
├─────────────┤       ├─────────────┤       ├─────────────┤
│ id          │──┐    │ id          │──┐    │ id          │
│ username    │  │    │ user_id     │◄─┘    │ session_id  │◄┐
│ email       │  │    │ title       │       │ content     │ │
│ password    │  └───►│ status      │       │ charts      │ │
│ role        │       │ created_at  │───────│ version     │ │
│ created_at  │       │ updated_at  │       │ created_at  │ │
└─────────────┘       └─────────────┘       └─────────────┘ │
                                                            │
┌─────────────┐       ┌─────────────┐       ┌─────────────┐ │
│   Dialog    │       │    Chart    │       │   Version   │ │
├─────────────┤       ├─────────────┤       ├─────────────┤ │
│ id          │       │ id          │       │ id          │ │
│ session_id  │◄──────│ report_id   │◄──────│ report_id   │◄┘
│ role        │       │ type        │       │ version_no  │
│ content     │       │ config      │       │ snapshot    │
│ created_at  │       │ created_at  │       │ created_at  │
└─────────────┘       └─────────────┘       └─────────────┘

┌─────────────┐       ┌─────────────┐
│  Template   │       │  Workflow   │
├─────────────┤       ├─────────────┤
│ id          │       │ id          │
│ name        │       │ name        │
│ description │       │ type        │
│ prompt      │       │ config      │
│ category    │       │ is_default  │
│ created_at  │       │ created_at  │
└─────────────┘       └─────────────┘
```

#### 核心表结构

```sql
-- 用户表
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100),
    password_hash VARCHAR(255) NOT NULL,
    role VARCHAR(20) DEFAULT 'user',  -- user, admin, superadmin
    avatar_url VARCHAR(500),
    preferences JSONB DEFAULT '{}',
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    last_login_at TIMESTAMP
);

-- 分析会话表
CREATE TABLE analysis_sessions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    title VARCHAR(200),
    description TEXT,
    file_name VARCHAR(255),
    file_path VARCHAR(500),
    file_meta JSONB,  -- 文件元信息：大小、sheet数等
    analysis_request TEXT,
    status VARCHAR(20) DEFAULT 'created',  -- created, analyzing, completed, failed
    workflow_id INTEGER REFERENCES workflows(id),
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- 分析报告表
CREATE TABLE reports (
    id SERIAL PRIMARY KEY,
    session_id INTEGER REFERENCES analysis_sessions(id),
    content_text TEXT,  -- Markdown格式的文字报告
    content_summary TEXT,  -- 摘要
    key_findings JSONB,  -- 关键发现
    recommendations JSONB,  -- 行动建议
    metrics JSONB,  -- 核心指标
    is_current BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT NOW()
);

-- 图表表
CREATE TABLE charts (
    id SERIAL PRIMARY KEY,
    report_id INTEGER REFERENCES reports(id),
    chart_type VARCHAR(50),  -- bar, line, pie, scatter...
    title VARCHAR(200),
    config JSONB,  -- ECharts配置
    data JSONB,  -- 图表数据
    html_content TEXT,  -- 渲染后的HTML
    sort_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- 对话历史表
CREATE TABLE dialog_history (
    id SERIAL PRIMARY KEY,
    session_id INTEGER REFERENCES analysis_sessions(id),
    role VARCHAR(20),  -- user, assistant, system
    content TEXT,
    intent VARCHAR(50),  -- 识别到的意图
    entities JSONB,  -- 抽取的实体
    created_at TIMESTAMP DEFAULT NOW()
);

-- 报告版本表
CREATE TABLE report_versions (
    id SERIAL PRIMARY KEY,
    report_id INTEGER REFERENCES reports(id),
    version_no INTEGER,
    snapshot JSONB,  -- 完整快照
    change_summary TEXT,  -- 变更说明
    created_by INTEGER REFERENCES users(id),
    created_at TIMESTAMP DEFAULT NOW()
);

-- 模板表
CREATE TABLE templates (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    description TEXT,
    category VARCHAR(50),  -- daily, weekly, monthly, custom
    prompt_template TEXT,
    output_format JSONB,
    is_system BOOLEAN DEFAULT false,
    created_by INTEGER REFERENCES users(id),
    created_at TIMESTAMP DEFAULT NOW()
);

-- 工作流配置表
CREATE TABLE workflows (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    type VARCHAR(50),  -- dify, bailian, openai, langchain
    config JSONB,  -- API密钥、URL等配置
    is_default BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### 4.4 API设计规范

#### RESTful API 设计

```yaml
# 基础URL: /api/v1

# 认证相关
POST   /auth/login              # 用户登录
POST   /auth/logout             # 用户登出
POST   /auth/register           # 用户注册
POST   /auth/refresh            # 刷新Token

# 分析会话
GET    /sessions                # 获取会话列表
POST   /sessions                # 创建新会话
GET    /sessions/{id}           # 获取会话详情
PUT    /sessions/{id}           # 更新会话
DELETE /sessions/{id}           # 删除会话

# 文件上传
POST   /sessions/{id}/upload    # 上传分析文件
GET    /sessions/{id}/file      # 获取文件信息

# 分析执行
POST   /sessions/{id}/analyze   # 开始分析
GET    /sessions/{id}/status    # 获取分析状态（SSE流式）
POST   /sessions/{id}/cancel    # 取消分析

# 报告相关
GET    /sessions/{id}/report    # 获取分析报告
PUT    /sessions/{id}/report    # 更新报告内容
GET    /sessions/{id}/versions  # 获取版本历史
POST   /sessions/{id}/versions  # 保存新版本
GET    /sessions/{id}/versions/{v} # 获取指定版本

# 图表相关
GET    /sessions/{id}/charts    # 获取所有图表
PUT    /sessions/{id}/charts/{cid} # 更新图表配置
POST   /sessions/{id}/charts/{cid}/regenerate # 重新生成图表

# 对话相关
POST   /sessions/{id}/dialog    # 发送对话消息（SSE流式）
GET    /sessions/{id}/dialog/history # 获取对话历史
DELETE /sessions/{id}/dialog/history # 清空对话历史

# 导出相关
POST   /sessions/{id}/export/pdf  # 导出PDF
POST   /sessions/{id}/export/pptx # 导出PPT
POST   /sessions/{id}/export/image # 导出图片

# 模板相关
GET    /templates               # 获取模板列表
POST   /templates               # 创建模板
GET    /templates/{id}          # 获取模板详情
PUT    /templates/{id}          # 更新模板
DELETE /templates/{id}          # 删除模板

# 管理相关（需要管理员权限）
GET    /admin/users             # 用户管理
GET    /admin/workflows         # 工作流管理
GET    /admin/statistics        # 系统统计
```

#### 响应格式规范

```typescript
// 成功响应
{
  "success": true,
  "data": { ... },
  "message": "操作成功"
}

// 分页响应
{
  "success": true,
  "data": {
    "items": [ ... ],
    "total": 100,
    "page": 1,
    "page_size": 20
  }
}

// 错误响应
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "文件格式不支持",
    "details": { ... }
  }
}

// 流式响应（SSE）
event: progress
data: {"stage": "parsing", "progress": 30, "message": "正在解析数据..."}

event: progress
data: {"stage": "analyzing", "progress": 60, "message": "AI分析中..."}

event: complete
data: {"report_id": 123, "message": "分析完成"}
```

---

## 第五部分：功能详细设计

### 5.1 数据接入模块

#### 5.1.1 文件上传

```
┌─────────────────────────────────────────────────────────────┐
│                      文件上传区域                            │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                       │   │
│  │     ┌──────────┐                                     │   │
│  │     │   📁    │     拖拽文件到此处上传                │   │
│  │     └──────────┘     或 点击选择文件                  │   │
│  │                                                       │   │
│  │     支持格式：xlsx, xls, csv                         │   │
│  │     最大文件：50MB                                    │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  最近上传：                                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 📊 销售数据_202412.xlsx    2.3MB    刚刚           │   │
│  │ 📊 用户行为_周报.csv       1.1MB    2小时前        │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

**功能规格**：

| 属性 | 规格 |
|------|------|
| 支持格式 | .xlsx, .xls, .csv |
| 文件大小 | 最大50MB |
| 编码支持 | UTF-8, GBK, GB2312 |
| Sheet支持 | 自动识别多Sheet |
| 预览功能 | 显示前100行数据 |
| 智能识别 | 自动识别表头、数据类型 |

#### 5.1.2 数据预览

```
┌─────────────────────────────────────────────────────────────┐
│  📊 销售数据_202412.xlsx                           [关闭]  │
├─────────────────────────────────────────────────────────────┤
│  Sheet: [Sheet1 ▼]    行数: 1,234    列数: 15              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  │ 日期       │ 产品名称  │ 销售额   │ 数量  │ 地区    │  │
│  ├────────────┼──────────┼─────────┼───────┼─────────┤  │
│  │ 2024-12-01 │ 产品A    │ 12,500  │ 50    │ 华东    │  │
│  │ 2024-12-01 │ 产品B    │ 8,300   │ 32    │ 华北    │  │
│  │ 2024-12-02 │ 产品A    │ 15,200  │ 61    │ 华东    │  │
│  │ ...        │ ...      │ ...     │ ...   │ ...     │  │
│  │ (显示前100行)                                       │  │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  🔍 数据概览：                                              │
│  • 时间范围：2024-12-01 ~ 2024-12-25                        │
│  • 数值列：销售额、数量                                      │
│  • 分类列：产品名称、地区                                    │
│  • 缺失值：3行（0.2%）                                       │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 智能分析模块

#### 5.2.1 分析输入

```
┌─────────────────────────────────────────────────────────────┐
│                      分析需求输入                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 请分析12月的销售趋势，找出表现最好的产品和地区，     │   │
│  │ 并给出下月的销售建议_                                │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  💡 智能建议：                                              │
│  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐  │
│  │ 📈 趋势分析     │ │ 🏆 TOP排名     │ │ 📊 环比对比    │  │
│  └────────────────┘ └────────────────┘ └────────────────┘  │
│                                                             │
│  ⚙️ 高级选项 [展开]                                         │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 报告模板：[智能推荐 ▼]                                │   │
│  │ 图表风格：[商务蓝 ▼]                                  │   │
│  │ 输出格式：☑️ 在线预览  ☑️ PDF  ☐ PPT                 │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│                            [🚀 开始分析]                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 5.2.2 分析进度

```
┌─────────────────────────────────────────────────────────────┐
│                      分析进行中...                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ████████████████████░░░░░░░░░░░░░░░░░░░░  45%       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  当前步骤：正在进行趋势分析...                               │
│                                                             │
│  ✅ 数据解析完成                                            │
│  ✅ 数据清洗完成                                            │
│  ✅ 基础统计完成                                            │
│  🔄 趋势分析中...                                           │
│  ⏳ 生成图表                                                │
│  ⏳ 撰写报告                                                │
│                                                             │
│  预计剩余时间：约 15 秒                                      │
│                                                             │
│                            [取消分析]                        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 5.3 报告展示模块

#### 5.3.1 报告布局

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📊 12月销售数据分析报告                    [编辑] [导出▼] [分享]      │
├─────────────┬───────────────────────────────────────────────────────────┤
│             │                                                           │
│  目录       │  # 执行摘要                                               │
│             │                                                           │
│  ├ 执行摘要 │  本月销售总额达到 **358万元**，环比增长 **12.5%**。       │
│  ├ 关键发现 │  华东地区表现最佳，贡献了 45% 的销售额。                  │
│  ├ 趋势分析 │                                                           │
│  ├ 产品分析 │  ┌────────────────────────────────────────────────┐      │
│  ├ 地区分析 │  │            12月销售趋势                         │      │
│  └ 建议     │  │  [折线图：日销售额走势]                         │      │
│             │  │                                                  │      │
│             │  │   30k ─┬─────────────────────────────          │      │
│             │  │        │    ╱╲      ╱╲                          │      │
│             │  │   20k ─┼───╱──╲────╱──╲──────                  │      │
│             │  │        │  ╱    ╲  ╱                             │      │
│             │  │   10k ─┼─╱──────╲╱──────────                   │      │
│             │  │        │                                        │      │
│             │  │    0  ─┴───┬───┬───┬───┬───                    │      │
│             │  │           1日  7日 14日 21日                    │      │
│             │  └────────────────────────────────────────────────┘      │
│             │                                                           │
│             │  ## 关键发现                                              │
│             │                                                           │
│             │  1. **产品A** 销售额最高，占比 35%                        │
│             │  2. **华东地区** 增速最快，环比 +18%                      │
│             │  3. 周末销售额明显高于工作日，建议加强促销                │
│             │                                                           │
├─────────────┴───────────────────────────────────────────────────────────┤
│                                                                         │
│  💬 AI助手                                          [展开对话面板 →]   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

#### 5.3.2 图表交互

```
┌─────────────────────────────────────────────────────────────┐
│  12月销售趋势                              [📊] [✏️] [📥]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   35k ─┬────────────────────────────────────────────────   │
│        │                    ●                               │
│   28k ─┼───────────────────╱╲──────────────────────────   │
│        │        ●         ╱  ╲        ●                    │
│   21k ─┼───────╱╲────────╱────╲──────╱╲────────────────   │
│        │      ╱  ╲      ╱      ╲    ╱  ╲                   │
│   14k ─┼─────╱────╲────╱────────╲──╱────╲──────────────   │
│        │    ╱      ╲  ╱          ╲╱      ╲                 │
│    7k ─┼───╱────────╲╱────────────────────╲────────────   │
│        │  ╱                                                 │
│    0  ─┴──┬────┬────┬────┬────┬────┬────┬────┬─────────   │
│          12/1  12/5  12/9 12/13 12/17 12/21 12/25          │
│                                                             │
│  ─●─ 销售额    ─●─ 订单数（右轴）                          │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  数据洞察：12月15日达到峰值，可能与双12促销活动相关         │
└─────────────────────────────────────────────────────────────┘

点击 [✏️] 进入编辑模式：

┌─────────────────────────────────────────────────────────────┐
│  图表编辑器                                        [保存]   │
├───────────────┬─────────────────────────────────────────────┤
│  图表类型     │  ● 折线图  ○ 柱状图  ○ 面积图              │
├───────────────┼─────────────────────────────────────────────┤
│  颜色主题     │  [商务蓝 ▼]                                 │
├───────────────┼─────────────────────────────────────────────┤
│  显示元素     │  ☑️ 数据标签  ☑️ 图例  ☑️ 网格线          │
├───────────────┼─────────────────────────────────────────────┤
│  标题         │  [12月销售趋势_______________]              │
├───────────────┼─────────────────────────────────────────────┤
│  AI助手       │  [输入修改需求，如"换成柱状图"...]         │
└───────────────┴─────────────────────────────────────────────┘
```

### 5.4 对话探索模块

#### 5.4.1 对话界面

```
┌─────────────────────────────────────────────────────────────┐
│  💬 AI分析助手                                     [清空]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 👤 哪个产品的增长率最高？                            │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 🤖 根据数据分析，**产品C** 的增长率最高：            │   │
│  │                                                       │   │
│  │    • 本月销售额：45.2万                               │   │
│  │    • 上月销售额：32.1万                               │   │
│  │    • 环比增长：**40.8%**                              │   │
│  │                                                       │   │
│  │    主要原因分析：                                     │   │
│  │    1. 12月10日上线新版本，用户好评增加                │   │
│  │    2. 华南地区新开3家经销商                           │   │
│  │                                                       │   │
│  │    [查看详细数据] [生成图表]                          │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 👤 对比一下所有产品的增长情况                        │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 🤖 好的，这是所有产品的增长对比：                    │   │
│  │                                                       │   │
│  │    ┌──────────────────────────────────────┐          │   │
│  │    │   [柱状图：各产品增长率对比]          │          │   │
│  │    │                                        │          │   │
│  │    │   产品C ████████████████ 40.8%        │          │   │
│  │    │   产品A ████████████ 28.5%            │          │   │
│  │    │   产品B ██████████ 22.1%              │          │   │
│  │    │   产品D ████████ 18.3%                │          │   │
│  │    │                                        │          │   │
│  │    └──────────────────────────────────────┘          │   │
│  │                                                       │   │
│  │    [添加到报告] [下载图表]                            │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 输入问题，按 Enter 发送...                           │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  快捷问题：[趋势分析] [异常检测] [对比分析] [预测]        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 5.5 模板中心

#### 5.5.1 模板列表

```
┌─────────────────────────────────────────────────────────────────────────┐
│  📋 模板中心                              [搜索模板...]   [+ 创建模板]  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  分类：[全部] [日报] [周报] [月报] [专项分析] [我的模板]               │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  系统模板                                                               │
│  ┌────────────────────┐ ┌────────────────────┐ ┌────────────────────┐  │
│  │ 📊 运营日报        │ │ 📈 销售周报        │ │ 👥 用户分析        │  │
│  │                    │ │                    │ │                    │  │
│  │ 每日核心指标汇总   │ │ 周度销售趋势分析   │ │ 用户行为深度分析   │  │
│  │ 适合：运营团队     │ │ 适合：销售团队     │ │ 适合：产品团队     │  │
│  │                    │ │                    │ │                    │  │
│  │ ⭐ 4.8  使用 2.3k │ │ ⭐ 4.6  使用 1.8k │ │ ⭐ 4.5  使用 1.2k │  │
│  │                    │ │                    │ │                    │  │
│  │ [使用此模板]       │ │ [使用此模板]       │ │ [使用此模板]       │  │
│  └────────────────────┘ └────────────────────┘ └────────────────────┘  │
│                                                                         │
│  ┌────────────────────┐ ┌────────────────────┐ ┌────────────────────┐  │
│  │ 🎮 游戏运营报告    │ │ 🔄 留存分析        │ │ 💰 LTV分析         │  │
│  │                    │ │                    │ │                    │  │
│  │ 游戏数据专项分析   │ │ 用户留存率分析     │ │ 用户生命周期价值   │  │
│  │ 适合：游戏运营     │ │ 适合：增长团队     │ │ 适合：商业化团队   │  │
│  │                    │ │                    │ │                    │  │
│  │ ⭐ 4.9  使用 3.1k │ │ ⭐ 4.7  使用 2.0k │ │ ⭐ 4.4  使用 0.9k │  │
│  │                    │ │                    │ │                    │  │
│  │ [使用此模板]       │ │ [使用此模板]       │ │ [使用此模板]       │  │
│  └────────────────────┘ └────────────────────┘ └────────────────────┘  │
│                                                                         │
│  我的模板                                                               │
│  ┌────────────────────┐ ┌────────────────────┐                         │
│  │ 📝 周会汇报模板    │ │ + 创建新模板       │                         │
│  │                    │ │                    │                         │
│  │ 自定义周会报告格式 │ │                    │                         │
│  │ 创建于 2024-12-20 │ │                    │                         │
│  │                    │ │                    │                         │
│  │ [使用] [编辑] [删除] │                    │                         │
│  └────────────────────┘ └────────────────────┘                         │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 5.6 导出功能

#### 5.6.1 导出选项

```
┌─────────────────────────────────────────────────────────────┐
│  📥 导出报告                                       [关闭]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  导出格式                                                   │
│  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐│
│  │      📄        │ │      📊        │ │      🖼️        ││
│  │     PDF        │ │     PPTX       │ │     PNG        ││
│  │                │ │                │ │                ││
│  │ 适合打印和存档 │ │ 适合演示汇报   │ │ 适合社交分享   ││
│  │                │ │                │ │                ││
│  │    ● 选中      │ │    ○          │ │    ○          ││
│  └─────────────────┘ └─────────────────┘ └─────────────────┘│
│                                                             │
│  PDF选项                                                    │
│  ├─ 纸张大小：[A4 ▼]                                        │
│  ├─ 方向：○ 纵向  ● 横向                                   │
│  ├─ 包含内容：                                              │
│  │  ☑️ 封面      ☑️ 目录      ☑️ 执行摘要                 │
│  │  ☑️ 详细分析  ☑️ 图表      ☑️ 数据附录                 │
│  ├─ 水印：[无 ▼]                                            │
│  └─ 页眉Logo：[点击上传]                                    │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 预览                                                  │   │
│  │ ┌─────────────────────────────────────────────────┐ │   │
│  │ │                                                   │ │   │
│  │ │           12月销售数据分析报告                    │ │   │
│  │ │                                                   │ │   │
│  │ │              智析数据分析平台                     │ │   │
│  │ │              2024年12月26日                       │ │   │
│  │ │                                                   │ │   │
│  │ └─────────────────────────────────────────────────┘ │   │
│  │                    [1] / 12 页                        │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│                              [取消]  [导出]                 │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 第六部分：交互设计规范

### 6.1 设计原则

| 原则 | 说明 | 示例 |
|------|------|------|
| **即时反馈** | 每个操作都有响应 | 上传进度条、分析状态 |
| **渐进披露** | 复杂功能逐步展示 | 高级选项默认折叠 |
| **容错设计** | 允许撤销和重试 | 历史版本、重新分析 |
| **一致性** | 相同操作相同反馈 | 统一的按钮样式和位置 |
| **可见性** | 重要功能显而易见 | 主操作按钮突出显示 |

### 6.2 布局规范

```
┌─────────────────────────────────────────────────────────────────────────┐
│  顶部导航栏（64px）                                                     │
│  Logo    导航菜单                              用户头像  设置  退出     │
├─────────────────────────────────────────────────────────────────────────┤
│         │                                                               │
│  侧边栏  │                    主内容区                                   │
│ (240px) │                   (自适应宽度)                                 │
│  可折叠  │                                                               │
│         │  ┌───────────────────────────────────────────────────────┐   │
│  • 首页  │  │                                                       │   │
│  • 分析  │  │                    内容区域                           │   │
│  • 模板  │  │                   (有最大宽度限制)                     │   │
│  • 历史  │  │                                                       │   │
│         │  │                                                       │   │
│         │  └───────────────────────────────────────────────────────┘   │
│         │                                                               │
├─────────────────────────────────────────────────────────────────────────┤
│  底部状态栏（可选，32px）                                               │
└─────────────────────────────────────────────────────────────────────────┘
```

### 6.3 颜色规范

```css
/* 主色调 - Arco Design 蓝 */
--color-primary: #165DFF;
--color-primary-light: #4080FF;
--color-primary-dark: #0E42D2;

/* 功能色 */
--color-success: #00B42A;  /* 成功 */
--color-warning: #FF7D00;  /* 警告 */
--color-danger: #F53F3F;   /* 危险 */
--color-info: #165DFF;     /* 信息 */

/* 中性色 */
--color-text-1: #1D2129;   /* 标题 */
--color-text-2: #4E5969;   /* 正文 */
--color-text-3: #86909C;   /* 次要 */
--color-text-4: #C9CDD4;   /* 禁用 */

/* 背景色 */
--color-bg-1: #FFFFFF;     /* 主背景 */
--color-bg-2: #F7F8FA;     /* 次背景 */
--color-bg-3: #F2F3F5;     /* 深背景 */

/* 边框色 */
--color-border: #E5E6EB;
--color-border-light: #F2F3F5;
```

### 6.4 字体规范

```css
/* 字体家族 */
font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC',
             'Hiragino Sans GB', 'Microsoft YaHei', 'Helvetica Neue',
             sans-serif;

/* 字号规范 */
--font-size-title: 20px;    /* 页面标题 */
--font-size-subtitle: 16px; /* 副标题 */
--font-size-body: 14px;     /* 正文 */
--font-size-caption: 12px;  /* 辅助文字 */

/* 行高 */
--line-height-tight: 1.4;
--line-height-normal: 1.6;
--line-height-loose: 1.8;
```

### 6.5 间距规范

```css
/* 间距系统（4px基准） */
--spacing-xs: 4px;
--spacing-sm: 8px;
--spacing-md: 16px;
--spacing-lg: 24px;
--spacing-xl: 32px;
--spacing-xxl: 48px;

/* 圆角 */
--radius-sm: 4px;
--radius-md: 8px;
--radius-lg: 12px;
--radius-full: 9999px;
```

---

## 第七部分：实施路线图

### 7.1 版本规划

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           版本路线图                                     │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  V4.0 MVP                    V4.1 增强                  V4.2 协作       │
│  ──────────                  ─────────                  ─────────       │
│                                                                         │
│  ✅ UI框架迁移               ⬜ 模板中心                ⬜ 团队空间     │
│  ✅ 核心分析流程             ⬜ 数据库连接              ⬜ 协作编辑     │
│  ✅ AI对话优化               ⬜ 定时报告                ⬜ 评论批注     │
│  ✅ 报告导出                 ⬜ 邮件订阅                ⬜ 分享链接     │
│  ✅ 图表编辑                 ⬜ 批量下载                ⬜ 权限管理     │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────────  │
│                                                                         │
│  V5.0 智能化                 V5.1 生态                  V6.0 平台化     │
│  ──────────                  ─────────                  ─────────       │
│                                                                         │
│  ⬜ 异常自动预警             ⬜ API开放                 ⬜ 插件市场     │
│  ⬜ 智能推荐                 ⬜ 第三方集成              ⬜ 自定义看板   │
│  ⬜ 预测分析                 ⬜ Webhook                 ⬜ 数据中台     │
│  ⬜ 自然语言生成SQL          ⬜ 嵌入式组件              ⬜ 多租户       │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 7.2 V4.0 详细任务分解

| 阶段 | 任务 | 优先级 | 状态 |
|------|------|--------|------|
| **Phase 1: 基础设施** | | | |
| | UI框架迁移（Element Plus → Arco Design） | P0 | 待开始 |
| | 设计系统搭建（颜色、字体、间距） | P0 | 待开始 |
| | 公共组件开发 | P0 | 待开始 |
| **Phase 2: 核心功能** | | | |
| | 首页改版 | P0 | 待开始 |
| | 数据上传优化 | P0 | 待开始 |
| | 分析流程优化 | P0 | 待开��� |
| | 报告展示优化 | P0 | 待开始 |
| **Phase 3: 交互优化** | | | |
| | AI对话面板优化 | P1 | 待开始 |
| | 图表编辑器升级 | P1 | 待开始 |
| | 导出功能增强 | P1 | 待开始 |
| **Phase 4: 测试上线** | | | |
| | 功能测试 | P0 | 待开始 |
| | 性能优化 | P1 | 待开始 |
| | 文档完善 | P2 | 待开始 |

### 7.3 成功指标

| 指标 | 当前值 | 目标值 | 衡量方式 |
|------|--------|--------|----------|
| 分析完成率 | 85% | 95% | 成功分析数/总请求数 |
| 平均分析时间 | 45秒 | 20秒 | 从上传到报告生成 |
| 用户满意度 | - | 4.5/5 | 用户评分 |
| 日活用户 | - | 100+ | DAU统计 |
| 报告导出数 | - | 500+/周 | 导出统计 |

---

## 第八部分：附录

### 8.1 术语表

| 术语 | 定义 |
|------|------|
| DAU | 日活跃用户数 |
| MAU | 月活跃用户数 |
| 留存率 | 新用户在一定时间后继续使用的比例 |
| LTV | 用户生命周期价值 |
| 漏斗 | 用户转化路径分析 |
| 环比 | 与上一周期相比 |
| 同比 | 与去年同期相比 |

### 8.2 参考资料

- [Arco Design Vue 官方文档](https://arco.design/vue)
- [ECharts 图表库](https://echarts.apache.org/)
- [FastAPI 官方文档](https://fastapi.tiangolo.com/)
- [数据可视化最佳实践](https://www.tableau.com/learn/articles/data-visualization-tips)

### 8.3 修订历史

| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| 1.0 | 2024-12-26 | 初稿完成 | AI Assistant |

---

*本文档基于第一性原理，从数据分析的本质需求出发，重新设计了运营数据分析平台的产品架构和功能模块。*
